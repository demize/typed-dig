[tox]
requires =
    tox>=4
env_list =
    py{310,311,312}
    lint
    static
    coverage

[gh]
python =
    3.10: py310
    3.11: py311
    3.12: py312

[testenv]
description = run our tests with pytest
deps =
    pytest
    numpy
    pandas
commands =
    pytest {posargs:tests}

[testenv:lint]
description = run our linter
deps =
    ruff
commands =
    ruff check .

[testenv:static]
description = run pyanalyze for static analysis
deps =
    pyanalyze
    numpy
    pandas
    pytest
commands =
    pyanalyze --config-file=pyproject.toml

[testenv:coverage]
description = run our tests with pytest and generate a coverage report
deps =
    pytest
    pytest-cov
    numpy
    pandas
commands =
    pytest --cov=typed_dig {posargs:tests}
